<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Car Comparison - Luxury Motors</title>
    <link rel="stylesheet" href="styles.css">
    <script src="script.js" defer></script>
    <style>
        .comparison-hero {
            height: 40vh;
            background: linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6)), url('assets/images/BACKBUG2.jpg');
            background-size: cover;
            background-position: center;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            text-align: center;
        }
        
        .comparison-section {
            padding: 80px 0;
            background: #f8f8f8;
        }
        
        .comparison-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        .comparison-table {
            background: #fff;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            overflow-x: auto;
        }
        
        .comparison-grid {
            display: grid;
            grid-template-columns: 200px repeat(auto-fit, minmax(250px, 1fr));
            min-width: 800px;
        }
        
        .comparison-header {
            background: #333;
            color: #fff;
            padding: 20px;
            font-weight: bold;
            text-align: center;
        }
        
        .car-comparison-card {
            padding: 20px;
            text-align: center;
            border-right: 1px solid #eee;
        }
        
        .car-comparison-card:last-child {
            border-right: none;
        }
        
        .car-comparison-card img {
            width: 100%;
            height: 150px;
            object-fit: cover;
            border-radius: 10px;
            margin-bottom: 15px;
        }
        
        .car-comparison-card h3 {
            margin-bottom: 10px;
            color: #333;
        }
        
        .car-comparison-card .price {
            color: #ffd700;
            font-weight: bold;
            font-size: 1.2rem;
        }
        
        .spec-row {
            display: contents;
        }
        
        .spec-label {
            background: #f8f8f8;
            padding: 15px 20px;
            font-weight: bold;
            color: #333;
            border-bottom: 1px solid #eee;
            display: flex;
            align-items: center;
        }
        
        .spec-value {
            padding: 15px 20px;
            border-bottom: 1px solid #eee;
            border-right: 1px solid #eee;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }
        
        .spec-value:last-child {
            border-right: none;
        }
        
        .comparison-actions {
            text-align: center;
            margin-top: 40px;
        }
        
        .clear-comparison {
            background: #ff4444;
            color: #fff;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            margin-right: 15px;
            transition: all 0.3s ease;
        }
        
        .clear-comparison:hover {
            background: #cc3333;
            transform: translateY(-2px);
        }
        
        .add-more-cars {
            background: #ffd700;
            color: #000;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .add-more-cars:hover {
            background: #ffed4e;
            transform: translateY(-2px);
        }
        
        .empty-comparison {
            text-align: center;
            padding: 100px 20px;
            color: #666;
        }
        
        .empty-comparison h2 {
            margin-bottom: 20px;
            color: #333;
        }
        
        .winner-badge {
            background: #4CAF50;
            color: #fff;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: bold;
            margin-left: 10px;
        }
        
        @media (max-width: 768px) {
            .comparison-grid {
                grid-template-columns: 150px repeat(auto-fit, minmax(200px, 1fr));
                min-width: 600px;
            }
            
            .spec-label,
            .spec-value {
                padding: 10px;
                font-size: 0.9rem;
            }
            
            .car-comparison-card {
                padding: 15px;
            }
            
            .car-comparison-card img {
                height: 120px;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">
                <img src="assets/images/letter-l-icon-7.png" alt="Luxury Motors">
                <span>Luxury Motors</span>
            </div>
            <ul class="nav-menu">
                <li><a href="index.html" class="nav-link">Home</a></li>
                <li><a href="cars.html" class="nav-link">Inventory</a></li>
                <li><a href="index.html#about" class="nav-link">About</a></li>
                <li><a href="index.html#contact" class="nav-link">Contact</a></li>
                <li><a href="#" class="nav-link favorites-link">❤️ <span class="favorites-count">0</span></a></li>
                <li><a href="#" class="nav-link comparison-link" onclick="showComparison()">⚖️ <span class="comparison-count">0</span></a></li>
            </ul>
        </div>
    </nav>

    <!-- Comparison Hero -->
    <section class="comparison-hero">
        <div>
            <h1>Car Comparison</h1>
            <p>Compare specifications side by side</p>
        </div>
    </section>

    <!-- Comparison Section -->
    <section class="comparison-section">
        <div class="comparison-container">
            <div id="comparison-content">
                <!-- Content will be loaded by JavaScript -->
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    <img src="assets/images/letter-l-icon-7.png" alt="Luxury Motors">
                    <span>Luxury Motors</span>
                </div>
                <p>&copy; 2024 Luxury Motors. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            loadComparison();
        });

        function loadComparison() {
            const comparisonList = JSON.parse(localStorage.getItem('comparison')) || [];
            const comparisonContent = document.getElementById('comparison-content');
            
            if (comparisonList.length === 0) {
                comparisonContent.innerHTML = `
                    <div class="empty-comparison">
                        <h2>No Cars Selected for Comparison</h2>
                        <p>Go back to the inventory and select cars to compare</p>
                        <a href="cars.html" class="btn-primary">Browse Cars</a>
                    </div>
                `;
                return;
            }
            
            const comparisonCars = comparisonList.map(id => 
                carDatabase.find(car => car.id === id)
            ).filter(car => car);
            
            if (comparisonCars.length === 0) {
                comparisonContent.innerHTML = `
                    <div class="empty-comparison">
                        <h2>No Valid Cars Found</h2>
                        <p>The selected cars are no longer available</p>
                        <button onclick="clearComparison()" class="btn-primary">Clear Comparison</button>
                    </div>
                `;
                return;
            }
            
            comparisonContent.innerHTML = createComparisonTable(comparisonCars);
        }

        function createComparisonTable(cars) {
            const specs = [
                { label: 'Price', key: 'price', format: (val) => `$${val.toLocaleString()}`, compare: 'lower' },
                { label: 'Horsepower', key: 'hp', format: (val) => `${val} HP`, compare: 'higher' },
                { label: 'Top Speed', key: 'topSpeed', format: (val) => `${val} mph`, compare: 'higher' },
                { label: 'Engine', key: 'specs.engine', format: (val) => val },
                { label: 'Transmission', key: 'specs.transmission', format: (val) => val },
                { label: '0-60 mph', key: 'specs.acceleration', format: (val) => val, compare: 'lower' },
                { label: 'Weight', key: 'specs.weight', format: (val) => val, compare: 'lower' }
            ];
            
            return `
                <div class="comparison-table">
                    <div class="comparison-grid">
                        <div class="comparison-header">Specifications</div>
                        ${cars.map(car => `
                            <div class="car-comparison-card">
                                <img src="${car.image}" alt="${car.name}">
                                <h3>${car.name}</h3>
                                <div class="price">$${car.price.toLocaleString()}</div>
                                <button onclick="removeFromComparison(${car.id})" class="btn-outline" style="margin-top: 10px; padding: 5px 15px; font-size: 0.8rem;">Remove</button>
                            </div>
                        `).join('')}
                        
                        ${specs.map(spec => `
                            <div class="spec-row">
                                <div class="spec-label">${spec.label}</div>
                                ${cars.map(car => {
                                    const value = getNestedValue(car, spec.key);
                                    const formattedValue = spec.format ? spec.format(value) : value;
                                    const isWinner = spec.compare ? isSpecWinner(cars, spec.key, car.id, spec.compare) : false;
                                    
                                    return `
                                        <div class="spec-value">
                                            ${formattedValue}
                                            ${isWinner ? '<span class="winner-badge">Best</span>' : ''}
                                        </div>
                                    `;
                                }).join('')}
                            </div>
                        `).join('')}
                    </div>
                </div>
                
                <div class="comparison-actions">
                    <button onclick="clearComparison()" class="clear-comparison">Clear All</button>
                    <button onclick="window.location.href='cars.html'" class="add-more-cars">Add More Cars</button>
                </div>
            `;
        }

        function getNestedValue(obj, path) {
            return path.split('.').reduce((current, key) => current && current[key], obj);
        }

        function isSpecWinner(cars, specKey, carId, compareType) {
            const values = cars.map(car => ({
                id: car.id,
                value: getNestedValue(car, specKey)
            })).filter(item => typeof item.value === 'number');
            
            if (values.length === 0) return false;
            
            const currentCar = values.find(item => item.id === carId);
            if (!currentCar) return false;
            
            if (compareType === 'higher') {
                return currentCar.value === Math.max(...values.map(item => item.value));
            } else if (compareType === 'lower') {
                return currentCar.value === Math.min(...values.map(item => item.value));
            }
            
            return false;
        }

        function clearComparison() {
            localStorage.removeItem('comparison');
            comparisonList = [];
            updateComparisonCount();
            loadComparison();
            showNotification('Comparison cleared');
        }

        function removeFromComparison(carId) {
            let comparisonList = JSON.parse(localStorage.getItem('comparison')) || [];
            comparisonList = comparisonList.filter(id => id !== carId);
            localStorage.setItem('comparison', JSON.stringify(comparisonList));
            updateComparisonCount();
            loadComparison();
            showNotification('Car removed from comparison');
        }
    </script>
</body>
</html>
